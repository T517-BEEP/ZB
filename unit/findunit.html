<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>用户信息管理系统</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css" media="all">
    <link rel="stylesheet" href="./css/layuimini.css" media="all">
	<style>
		/* 全局样式调整 */
		body {
			background-color: #f5f7fa;
			padding: 20px;
		}
		/* 卡片容器样式 */
		.card-container {
			background-color: #fff;
			border-radius: 8px;
			box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
			margin-bottom: 20px;
			overflow: hidden;
		}
		/* 卡片标题样式 */
		.card-header {
			padding: 15px 20px;
			border-bottom: 1px solid #f2f2f2;
			font-size: 16px;
			color: #333;
			font-weight: 500;
		}
		/* 卡片内容样式 */
		.card-body {
			padding: 20px;
		}
		/* 搜索区域样式优化 */
		.table-search-fieldset {
			border-color: #e6e6e6;
			padding: 10px 15px;
			margin-bottom: 0;
		}
		.table-search-fieldset legend {
			color: #666;
			font-size: 14px;
			padding: 0 10px;
		}
		/* 按钮样式优化 */
		.layui-btn-normal {
			background-color: #4e6ef2;
		}
		.layui-btn-normal:hover {
			background-color: #3a57d5;
		}
		.layui-btn-danger {
			background-color: #f53f3f;
		}
		.layui-btn-danger:hover {
			background-color: #d83535;
		}
		/* 表格样式优化 */
		.layui-table {
			border-radius: 4px;
			overflow: hidden;
		}
		.layui-table th {
			background-color: #fafafa;
			color: #666;
			font-weight: 500;
		}
		.layui-table tr:hover {
			background-color: #f9f9f9;
		}
		
		}
		/* 状态开关样式 */
		.layui-form-switch {
			margin-top: 0;
		}
		.layui-form-onswitch {
			background-color: #4e6ef2;
			border-color: #4e6ef2;
		}
	</style>
</head>
<body>
	<!-- 页面标题 -->
	<div style="margin-bottom: 20px;">
		<h2 style="color: #333; font-weight: 500;">单位信息管理</h2>
		<p style="color: #999; margin-top: 5px;">管理单位的基本信息及状态</p>
	</div>

	<!-- 搜索区域卡片 -->
	<div class="card-container">
		<div class="card-header">搜索条件</div>
		<div class="card-body">
			<fieldset class="table-search-fieldset">
				<form class="layui-form layui-form-pane" action="">
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">单位名称</label>
							<div class="layui-input-inline" style="width: 200px;">
								<input type="text" name="deptname" placeholder="请输入单位名称" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">账号</label>
							<div class="layui-input-inline" style="width: 200px;">
								<input type="text" name="account" placeholder="请输入账号或手机号" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-inline">
							<button type="submit" class="layui-btn layui-btn-normal"  lay-submit lay-filter="data-search-btn">
								<i class="layui-icon"></i> 搜索
							</button>
							<button type="button" class="layui-btn layui-btn-primary" id="reset-btn">
								<i class="layui-icon"></i> 重置
							</button>
						</div>
					</div>
				</form>
			</fieldset>
		</div>
	</div>

	<!-- 表格区域卡片 -->
	<div class="card-container">
		<div class="card-header">用户信息列表</div>
		<div class="card-body">
			<!-- 工具栏 -->
			
			<!-- 数据表格 -->
			<table class="layui-table" id="studentTable" lay-filter="studentTableFilter"></table>

			<!-- 用户状态列模板 -->
			<script type="text/html" id="userStatus">
				<input type="checkbox" name="status" lay-skin="switch" lay-text="启用|禁用" 
				       lay-event="open" lay-filter="modifystatus" {{ d.status == '启用'? 'checked' : '' }}/>
			</script>

			<!-- 操作列模板 -->
			<script type="text/html" id="studentTableOperation">
				<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">
					<i class="layui-icon"></i> 详情
				</a>
				<a class="layui-btn layui-btn-normal layui-btn-xs" lay-event="edit">
					<i class="layui-icon"></i> 编辑
				</a>
				<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="delete">
					<i class="layui-icon"></i> 删除
				</a>
			</script>
		</div>
	</div>

	<script src="../lib/layui-v2.6.3/layui.js" charset="utf-8"></script>
	<script>
		layui.use(['form', 'table', 'laydate'], function () {
			var $ = layui.jquery;
			var form = layui.form;
			var table = layui.table;
			var laydate = layui.laydate;

			// 渲染表格
			table.render({
				elem: '#studentTable',
				url: 'unit.json',
				toolbar: '#studentTableToolbar',
				defaultToolbar: ['filter', 'exports', 'print'],
				cols: [[
					{type: "checkbox", width: 50, align: 'center'},
					{field: 'realname', width: 150, title: '单位名称', align: 'center'},
					{field: 'status', width: 140, title: '绑定平台', templet: '#userStatus', align: "center"},
					{field: 'deptname', width: 100, title: '联系人', align: 'center'},
					{field: 'majorname', width: 180, title: '账号', align: 'center'},
					{field: 'classname', width: 120, title: '手机号', align: 'center'},
					{field: 'telephone', width: 100, title: '群组数量', align: 'center'},
					{field: 'qq', width: 100, title: '用户数量', align: 'center'},
					{field: 'job', width: 140, title: '创建日期', align: 'center'},
				
					{title: '操作', minWidth: 180, toolbar: '#studentTableOperation', align: "center"}
				]],
				limits: [10, 15, 20, 25],
				limit: 10,
				page: true,
				skin: 'line',
				even: true, // 隔行变色
				loading: true // 加载动画
			});

			// 搜索功能
			form.on('submit(data-search-btn)', function (data) {
				table.reload('studentTable', {
					page: {curr: 1},
					where: data.field
				});
				return false;
			});

			// 重置按钮
			$('#reset-btn').click(function(){
				$('form')[0].reset();
				form.render();
			});

			// 状态切换
			form.on('switch(modifystatus)', function (obj) {
				var newStatus = obj.elem.checked ? '启用' : '禁用';
				layer.msg('用户状态已更新为：' + newStatus, {icon: 1, time: 1500});
			});

			// 工具栏操作
			table.on('toolbar(studentTableFilter)', function (obj) {
				if (obj.event === 'add') {
					layer.open({
						title: '添加新用户',
						type: 2,
						shade: 0.3,
						area: ['700px', '500px'],
						content: './user/addUser.html',
						maxmin: true
					});
				} else if (obj.event === 'delete') {
					var checkStatus = table.checkStatus('studentTable');
					if(checkStatus.data.length === 0){
						layer.msg('请先选择要删除的用户', {icon: 2, time: 1500});
						return;
					}
					layer.confirm('确定要删除选中的 ' + checkStatus.data.length + ' 条数据吗？', {
						icon: 3, 
						title: '确认删除'
					}, function (index) {
						layer.close(index);
						// 实际开发中这里需要调用接口删除数据
						layer.msg('删除成功', {icon: 1, time: 1500});
					});
				}
			});

			// 行操作
			table.on('tool(studentTableFilter)', function (obj) {
				var data = obj.data;
				if (obj.event === 'detail') {
					layer.open({
						title: '用户详情',
						type: 2,
						shade: 0.3,
						area: ['700px', '500px'],
						content: './viewunit.html',
						maxmin: true
					});
				} else if (obj.event === 'edit') {
					layer.open({
						title: '编辑用户',
						type: 2,
						shade: 0.3,
						area: ['700px', '500px'],
						content: './222.html',
						maxmin: true
					});
				} else if (obj.event === 'delete') {
					layer.confirm('确定要删除 ' + data.realname + ' 的信息吗？', {
						icon: 3, 
						title: '确认删除'
					}, function (index) {
						obj.del();
						layer.close(index);
						layer.msg('删除成功', {icon: 1, time: 1500});
					});
				}
			});
		});
	</script>
</body>
</html>